<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kaithi â†’ Hindi OCR (All-in-one)</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; background: #fafafa; color: #222; }
.card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }
h2 { margin-top: 0; }
input, button, textarea { font-size: 15px; }
textarea { width: 100%; height: 140px; padding: 8px; border: 1px solid #ccc; border-radius: 8px; }
button { background: #0078ff; color: white; border: none; padding: 10px 14px; border-radius: 6px; cursor: pointer; }
button:disabled { opacity: 0.6; cursor: not-allowed; }
progress { width: 100%; height: 12px; margin-top: 6px; }
#imgPreview { max-width: 100%; margin-top: 10px; border-radius: 8px; }
</style>
</head>
<body>
<div class="card">
  <h2>ðŸ“œ Kaithi â†’ Hindi OCR (All-in-one)</h2>
  <p>Upload an image with Kaithi script. It will extract text and open Hindi translation.</p>
  <input type="file" id="fileInput" accept="image/*"><br><br>
  <img id="imgPreview" />
  <br>
  <button id="startBtn" disabled>Start OCR</button>
  <progress id="progress" value="0" max="1"></progress>
  <p id="status">Idle</p>
  <h3>OCR Output</h3>
  <textarea id="result" placeholder="Recognized text will appear here..."></textarea><br>
  <button id="translateBtn" disabled>Translate to Hindi</button>
</div>

<!-- Tesseract.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js"></script>
<script>
const fileInput = document.getElementById('fileInput');
const startBtn = document.getElementById('startBtn');
const translateBtn = document.getElementById('translateBtn');
const result = document.getElementById('result');
const status = document.getElementById('status');
const progress = document.getElementById('progress');
const imgPreview = document.getElementById('imgPreview');

let imageData = null;

fileInput.addEventListener('change', e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    imageData = ev.target.result;
    imgPreview.src = imageData;
    startBtn.disabled = false;
  };
  reader.readAsDataURL(file);
});

startBtn.addEventListener('click', async () => {
  if (!imageData) return;
  startBtn.disabled = true;
  status.textContent = "Processing...";
  progress.value = 0;
  result.value = "";
  translateBtn.disabled = true;

  const worker = Tesseract.createWorker({
    logger: m => {
      if (m.status) status.textContent = m.status;
      if (m.progress) progress.value = m.progress;
    },
    langPath: 'https://tessdata.projectnaptha.com/4.0.0'
  });

  try {
    await worker.load();
    await worker.loadLanguage('kaithi');
    await worker.initialize('kaithi');
    const { data: { text } } = await worker.recognize(imageData);
    result.value = text.trim();
    translateBtn.disabled = text.trim() === "";
    status.textContent = "Done âœ…";
  } catch (e) {
    console.error(e);
    alert("Error: " + e.message);
    status.textContent = "Error occurred.";
  } finally {
    await worker.terminate();
    startBtn.disabled = false;
  }
});

translateBtn.addEventListener('click', () => {
  const text = result.value.trim();
  if (!text) return;
  const url = `https://translate.google.com/?sl=auto&tl=hi&text=${encodeURIComponent(text)}&op=translate`;
  window.open(url, '_blank');
});
</script>
</body>
</html>
